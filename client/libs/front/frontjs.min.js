// FrontJS v0.0.10
(function(t){function e(t,e,n){throw new Error("[Front] expected "+t+" to be "+e+" (got "+n+").")}function n(){this.started=!1,this.seq=0,this.pendingCb={},this.customTargetWindow=null,this.qs=o(),this.domain=this.qs.front_domain||"https://app.frontapp.com",this.visible=!1}function o(){for(var t=window.location.search.substring(1),e=t.split("&"),n={},o=0;o<e.length;o++){var i=e[o].split("=");2===i.length&&(n[decodeURIComponent(i[0])]=decodeURIComponent(i[1]))}return n}function i(t){return t?r(t):null}function r(t){return p.testString(t)?t:(p.isObject(t),p.isString(t.alias),t.alias)}function s(t){if(t.html)return t.html;if(t.body)return t.body;if(t.text){var e=document.createElement("div");return e.innerText=t.text,e.innerHTML}return""}!function(t,e,n){"function"==typeof define&&define.amd?define(n):"object"==typeof exports?module.exports=n():e[t]=n()}("heir",this,function(){"use strict";var t={inherit:function(e,n,o){var i=e.prototype=t.createObject(n.prototype);i.constructor=e,(o||"undefined"==typeof o)&&(e._super=n.prototype)},createObject:Object.create||function(t){var e=function(){};return e.prototype=t,new e},mixin:function(e,n){return t.merge(e.prototype,n)},merge:function(e,n){var o;for(o in n)t.hasOwn(n,o)&&(e[o]=n[o])},hasOwn:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}};return t}),function(){"use strict";function t(){}function e(t,e){for(var n=t.length;n--;)if(t[n].listener===e)return n;return-1}function n(t){return function(){return this[t].apply(this,arguments)}}var o=t.prototype,i=this,r=i.EventEmitter;o.getListeners=function(t){var e,n,o=this._getEvents();if(t instanceof RegExp){e={};for(n in o)o.hasOwnProperty(n)&&t.test(n)&&(e[n]=o[n])}else e=o[t]||(o[t]=[]);return e},o.flattenListeners=function(t){var e,n=[];for(e=0;e<t.length;e+=1)n.push(t[e].listener);return n},o.getListenersAsObject=function(t){var e,n=this.getListeners(t);return n instanceof Array&&(e={},e[t]=n),e||n},o.addListener=function(t,n){var o,i=this.getListenersAsObject(t),r="object"==typeof n;for(o in i)i.hasOwnProperty(o)&&-1===e(i[o],n)&&i[o].push(r?n:{listener:n,once:!1});return this},o.on=n("addListener"),o.addOnceListener=function(t,e){return this.addListener(t,{listener:e,once:!0})},o.once=n("addOnceListener"),o.defineEvent=function(t){return this.getListeners(t),this},o.defineEvents=function(t){for(var e=0;e<t.length;e+=1)this.defineEvent(t[e]);return this},o.removeListener=function(t,n){var o,i,r=this.getListenersAsObject(t);for(i in r)r.hasOwnProperty(i)&&(o=e(r[i],n),-1!==o&&r[i].splice(o,1));return this},o.off=n("removeListener"),o.addListeners=function(t,e){return this.manipulateListeners(!1,t,e)},o.removeListeners=function(t,e){return this.manipulateListeners(!0,t,e)},o.manipulateListeners=function(t,e,n){var o,i,r=t?this.removeListener:this.addListener,s=t?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(o=n.length;o--;)r.call(this,e,n[o]);else for(o in e)e.hasOwnProperty(o)&&(i=e[o])&&("function"==typeof i?r.call(this,o,i):s.call(this,o,i));return this},o.removeEvent=function(t){var e,n=typeof t,o=this._getEvents();if("string"===n)delete o[t];else if(t instanceof RegExp)for(e in o)o.hasOwnProperty(e)&&t.test(e)&&delete o[e];else delete this._events;return this},o.removeAllListeners=n("removeEvent"),o.emitEvent=function(t,e){var n,o,i,r,s,p=this.getListenersAsObject(t);for(r in p)if(p.hasOwnProperty(r))for(n=p[r].slice(0),i=n.length;i--;)o=n[i],o.once===!0&&this.removeListener(t,o.listener),s=o.listener.apply(this,e||[]),s===this._getOnceReturnValue()&&this.removeListener(t,o.listener);return this},o.trigger=n("emitEvent"),o.emit=function(t){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,e)},o.setOnceReturnValue=function(t){return this._onceReturnValue=t,this},o._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},o._getEvents=function(){return this._events||(this._events={})},t.noConflict=function(){return i.EventEmitter=r,t},"function"==typeof define&&define.amd?define(function(){return t}):"object"==typeof module&&module.exports?module.exports=t:i.EventEmitter=t}.call(this);var p={};["Arguments","Function","String","Number","Array","Date","RegExp","Boolean"].forEach(function(t){function n(e){return Object.prototype.toString.call(e)==="[object "+t+"]"}p["opt"+t]=function(t){return n(t)?t:null},p["is"+t]=function(o,i){n(o)||e(i,t,o)},p["test"+t]=function(t){return n(t)}}),p.isObject=function(t,n){var o=typeof t;"function"===o||"object"===o&&t||e(n,"Object",t)},this.heir.inherit(n,this.EventEmitter),n.prototype.init=function(t){t&&(this.customTargetWindow=document.querySelector(t).contentWindow)},n.prototype._validateDomain=function(){return t.allowAnyFrontDomain||/^https:\/\/[\w\-]+\.frontapp.com$/.test(this.domain)},n.prototype._connected=function(){this.emit(this.started?"reconnect":"ready"),this.started=!0},n.prototype._dispatch=function(t){var e=this.pendingCb[t.seq];delete this.pendingCb[t.seq],e&&"function"==typeof e&&e(t.val)},n.prototype._postCb=function(t,e){p.isFunction(e,"cb");var n=++this.seq;t.seq=n,this.pendingCb[n]=e,this.post(t)},n.prototype.post=function(e){var n=this.customTargetWindow||t.parent;n.postMessage(e,this.domain)},n.prototype.dialog=function(t,e,n){p.isObject(e,"options"),p.isString(e.title,"options.title"),p.isString(e.message,"options.message"),e.type=t,e.okTitle=p.optString(e.okTitle),e.cancelTitle=p.optString(e.cancelTitle),e.val=p.optString(e.val),this._postCb(e,n)},["alert","confirm","prompt","report"].forEach(function(t){n.prototype[t]=function(e,n){this.dialog(t,e,n)}}),n.prototype.promptDate=function(t,e){p.isObject(t,"options"),p.isObject(t.position,"options.position"),p.isNumber(t.position.left,"options.position.left"),p.isNumber(t.position.top,"options.position.top"),t.type="prompt_date",["val","before","after"].forEach(function(e){t[e]&&(p.isDate(t[e],"options."+e),t[e]=t[e].getTime())}),this._postCb(t,function(t){e(t&&new Date(t))})},n.prototype.fuzzylist=function(t,e){p.isObject(t,"options"),p.isArray(t.items,"options.items"),t.items.forEach(function(t){p.isString(t.title),p.optString(t.completion)}),t.type="fuzzylist",this._postCb(t,e)},n.prototype.copyToClipboard=function(t){this.post({type:"copy_clipboard",payload:t})},n.prototype.openUrl=function(t){this.post({type:"open_url",url:t})},n.prototype.openPopupUrl=function(t,e){this.post({type:"open_popup_url",url:t,title:e})},n.prototype.openPopup=function(e,n){var o=this;this._postCb({type:"will_open_popup"},function(){o._lastPopup=t.open(e,n,"menubar=no,title,resize,location=no,width=650,height=530")})},n.prototype.closePopup=function(){this._lastPopup&&(this._lastPopup.close(),this._lastPopup=null)},n.prototype.search=function(t){this.post({type:"search",query:t})},t.Front=new n,t.Front._validateDomain()||(console.error("[Front] could not validate host domain",t.Front.domain),t.Front=null),t.addEventListener("message",function(e){if(e.origin===t.Front.domain)switch(e.data.type){case"sync":t.Front._connected();break;case"user":t.Front.user=e.data.user;break;case"conversation":t.Front.emit("conversation",e.data);break;case"no_conversation":t.Front.emit("no_conversation");break;case"panel_visible":t.Front.visible=e.data.visible,t.Front.emit("panel_visible",e.data.visible);break;case"done":t.Front._dispatch(e.data)}}),t.addEventListener("click",function(e){function n(t,e){return t&&20!==e?"A"===t.tagName&&t.href?t:n(t.parentElement,e+1):null}if(0===e.button&&t.parent!==t){var o=n(e.target,0);if(o){if("_blank"!==o.target)return;e.preventDefault(),e.stopPropagation(),t.Front.openUrl(o.href)}}}),setTimeout(function(){var e=location.href.replace(/[?&]auth_secret=.*$/,"");t.Front.post({type:"plugin_connected",endpoint:e})},0),n.prototype.fetchConversation=function(t){this._postCb({type:"fetch_conversation"},t)},n.prototype.fetchTeam=function(t){this._postCb({type:"fetch_team"},t)},n.prototype.fetchAllowedTeammates=function(t){this._postCb({type:"fetch_allowed_teammates"},t)},n.prototype.fetchInboxes=function(t){this._postCb({type:"fetch_inboxes"},t)},n.prototype.fetchAllowedTags=function(t){this._postCb({type:"fetch_tags"},t)},n.prototype.fetchNotes=function(t){this._postCb({type:"fetch_notes"},t)},n.prototype.unassign=function(t){this.post({type:"unassign",conversation_id:t?t.id:null})},n.prototype.assign=function(t,e){var n=r(t);this.post({type:"assign",assignee:n,conversation_id:e?e.id:null})},n.prototype.attachTag=function(t,e){var n=r(t);this.post({type:"tag",tag:n,conversation_id:e?e.id:null})},n.prototype.detachTag=function(t,e){var n=r(t);this.post({type:"untag",tag:n,conversation_id:e?e.id:null})},n.prototype.toggleTag=function(t,e){var n=r(t);this.post({type:"toggle_tag",tag:n,conversation_id:e?e.id:null})},n.prototype.toggleArchive=function(t){this.post({type:"toggle_archived",conversation_id:t?t.id:null})},n.prototype.toggleTrashed=function(t){this.post({type:"toggle_trashed",conversation_id:t?t.id:null})},n.prototype.moveToInbox=function(t){var e=r(t);this.post({type:"move_to_inbox",inbox:e,inbox_alias:e})},n.prototype.addTopic=function(t,e){p.isObject(t),p.optString(t.type),p.optString(t.name),p.isString(t.ext_link),this._postCb({type:"add_topic",topic:t},e)},n.prototype.reply=function(t,e,n){t=t||{},p.isObject(t),p.optString(t.body),p.optString(t.html),p.optString(t.text),p.optString(t.subject),p.optBoolean(t.send_now),p.optBoolean(t.mark_archived),p.optString(t.to);var o=[];t.tags&&(p.isArray(t.tags),t.tags.forEach(function(t){o.push(r(t))})),this.post({type:e?"reply_all":"reply",tags:o,body:s(t),subject:t.subject||null,send_now:t.send_now||!1,mark_archived:t.mark_archived||null,to:t.to||null,conversation_id:n?n.id:null})},n.prototype.forwardTo=function(t,e){e=e||{},p.optString(t),p.optString(e.body),p.optString(e.subject),this.post({type:"forward",body:s(e),subject:e.subject||null,send_now:e.send_now||!1,mark_archived:e.mark_archived||null,to:t})},n.prototype.compose=function(t){t=t||{},p.isObject(t),p.optString(t.to),p.optString(t.subject),p.optString(t.body),p.optBoolean(t.send_now),p.optBoolean(t.mark_archived);var e=i(t.inbox),n=[];t.tags&&(p.isArray(t.tags),t.tags.forEach(function(t){n.push(r(t))})),this.post({type:"compose",to:t.to,body:s(t),subject:t.subject||null,send_now:t.send_now||!1,mark_archived:t.mark_archived||null,specifiedInboxAlias:e,tags:n})},n.prototype.insertHTML=function(t){p.isString(t),this.post({type:"insert_html",html:t})},n.prototype.setPanelWidth=function(t){p.isNumber(t),this.post({type:"set_width",width:t})}}).call({},window);
//# sourceMappingURL=frontjs.min.js.map
